{"version":3,"file":"vue-gtag.umd.min.js","sources":["../src/util.js","../src/api/query.js","../src/install.js","../src/api/config.js","../src/api/event.js","../src/api/pageview.js","../src/api/screenview.js","../src/api/ga-disable.js","../src/api/opt-out.js","../src/api/index.js","../src/api/custom-map.js","../src/api/time.js","../src/api/exception.js","../src/api/linker.js","../src/api/purchase.js","../src/api/refund.js","../src/api/set.js","../src/api/opt-in.js","../src/extend.js","../src/page-tracker.js","../src/bootstrap.js","../src/index.js"],"sourcesContent":["export const noop = function () {};\n\nexport function loadScript(url, options = {}) {\n  return new Promise((resolve, reject) => {\n    const head = document.head || document.getElementsByTagName(\"head\")[0];\n    const script = document.createElement(\"script\");\n\n    script.async = true;\n    script.src = url;\n    script.charset = \"utf-8\";\n    script.defer = options.defer;\n\n    if (options.preconnectOrigin) {\n      const link = document.createElement(\"link\");\n\n      link.href = options.preconnectOrigin;\n      link.rel = \"preconnect\";\n\n      head.appendChild(link);\n    }\n\n    head.appendChild(script);\n\n    script.onload = resolve;\n    script.onerror = reject;\n  });\n}\n\nexport function warn(msg) {\n  console.warn(\"[vue-gtag] \" + msg);\n}\n\nexport function isFn(item) {\n  return typeof item === \"function\";\n}\n\nexport function isObject(item) {\n  return item && typeof item === \"object\" && !Array.isArray(item);\n}\n\nexport function mergeDeep(target, ...sources) {\n  if (!sources.length) {\n    return target;\n  }\n\n  const source = sources.shift();\n\n  if (!isObject(target) || !isObject(source)) {\n    return;\n  }\n\n  for (const key in source) {\n    if (isObject(source[key])) {\n      if (!target[key]) {\n        Object.assign(target, { [key]: {} });\n      }\n\n      mergeDeep(target[key], source[key]);\n    } else {\n      Object.assign(target, { [key]: source[key] });\n    }\n  }\n\n  return mergeDeep(target, ...sources);\n}\n","import { getOptions } from \"../install\";\n\nexport default function (...args) {\n  const { globalObjectName } = getOptions();\n\n  if (typeof window === \"undefined\") {\n    return;\n  }\n\n  window[globalObjectName](...args);\n}\n","import { noop, mergeDeep } from \"./util\";\nimport extend from \"./extend\";\nimport bootstrap from \"./bootstrap\";\n\nlet Vue;\nlet Router;\n\nexport let options = {\n  customResourceURL: \"https://www.googletagmanager.com/gtag/js\",\n  customPreconnectOrigin: \"https://www.googletagmanager.com\",\n  pageTrackerTemplate: noop,\n  onBeforeTrack: noop,\n  onAfterTrack: noop,\n  onReady: noop,\n  enabled: true,\n  disableScriptLoad: false,\n  deferScriptLoad: false,\n  bootstrap: true,\n  globalObjectName: \"gtag\",\n  globalDataLayerName: \"dataLayer\",\n  pageTrackerEnabled: true,\n  pageTrackerScreenviewEnabled: false,\n  pageTrackerSkipSamePath: true,\n  defaultGroupName: \"default\",\n  includes: null,\n  appName: null,\n  config: {\n    id: null,\n    params: {\n      send_page_view: false,\n    },\n  },\n};\n\nexport const getOptions = () => options;\nexport const setOptions = (_options) => mergeDeep(options, _options);\nexport const getVue = () => Vue;\nexport const getRouter = () => Router;\n\nexport function install(_Vue, _options = {}, _Router) {\n  Vue = _Vue;\n  Router = _Router;\n\n  setOptions(_options);\n\n  extend();\n\n  if (!options.bootstrap) {\n    return;\n  }\n\n  bootstrap();\n}\n","import query from \"./query\";\nimport { getOptions } from \"../install\";\n\nexport default (...args) => {\n  const { config, includes } = getOptions();\n\n  query(\"config\", config.id, ...args);\n\n  if (Array.isArray(includes)) {\n    includes.forEach((domain) => {\n      query(\"config\", domain.id, ...args);\n    });\n  }\n};\n","import { getOptions } from \"../install\";\nimport query from \"./query\";\n\nexport default (name, _params = {}) => {\n  const { defaultGroupName, includes } = getOptions();\n  const params = _params;\n\n  if (includes && params.send_to == null) {\n    params.send_to = includes\n      .map((include) => include.id)\n      .concat(defaultGroupName);\n  }\n\n  query(\"event\", name, params);\n};\n","import event from \"./event\";\n\nexport default (...args) => {\n  const [arg] = args;\n  let params = {};\n\n  if (typeof arg === \"string\") {\n    params = {\n      page_path: arg,\n      page_location: window.location.href,\n    };\n  } else {\n    params = arg;\n  }\n\n  if (params.send_page_view == null) {\n    params.send_page_view = true;\n  }\n\n  event(\"page_view\", params);\n};\n","import { getOptions } from \"../install\";\nimport event from \"./event\";\n\nexport default (...args) => {\n  const { appName } = getOptions();\n  const [arg] = args;\n  let params = {};\n\n  if (typeof arg === \"string\") {\n    params = {\n      screen_name: arg,\n    };\n  } else {\n    params = arg;\n  }\n\n  if (params.app_name == null) {\n    params.app_name = appName;\n  }\n\n  if (params.send_page_view == null) {\n    params.send_page_view = true;\n  }\n\n  event(\"screen_view\", params);\n};\n","import { getOptions } from \"../install\";\n\nexport default (value = true) => {\n  const { includes, config } = getOptions();\n\n  window[`ga-disable-${config.id}`] = value;\n\n  if (Array.isArray(includes)) {\n    includes.forEach((domain) => {\n      window[`ga-disable-${domain.id}`] = value;\n    });\n  }\n};\n","import disable from \"./ga-disable\";\n\nexport default () => {\n  disable(true);\n};\n","import query from \"./query\";\nimport config from \"./config\";\nimport event from \"./event\";\nimport pageview from \"./pageview\";\nimport screenview from \"./screenview\";\nimport customMap from \"./custom-map\";\nimport time from \"./time\";\nimport exception from \"./exception\";\nimport linker from \"./linker\";\nimport purchase from \"./purchase\";\nimport refund from \"./refund\";\nimport set from \"./set\";\nimport optIn from \"./opt-in\";\nimport optOut from \"./opt-out\";\n\nexport default {\n  query,\n  config,\n  event,\n  pageview,\n  screenview,\n  customMap,\n  time,\n  exception,\n  linker,\n  purchase,\n  refund,\n  set,\n  optIn,\n  optOut,\n};\n","import config from \"./config\";\n\nexport default (map) => {\n  config({\n    custom_map: map,\n  });\n};\n","import event from \"./event\";\n\nexport default (...args) => {\n  event(\"timing_complete\", ...args);\n};\n","import event from \"./event\";\n\nexport default (...args) => {\n  event(\"exception\", ...args);\n};\n","import config from \"./config\";\n\nexport default (params) => {\n  config(\"linker\", params);\n};\n","import event from \"./event\";\n\nexport default (...args) => {\n  event(\"purchase\", ...args);\n};\n","import event from \"./event\";\n\nexport default (...args) => {\n  event(\"refund\", ...args);\n};\n","import query from \"./query\";\n\nexport default (...args) => {\n  query(\"set\", ...args);\n};\n","import disable from \"./ga-disable\";\n\nexport default () => {\n  disable(false);\n};\n","import { getVue } from \"./install\";\nimport api from \"./api\";\n\nexport default () => {\n  const Vue = getVue();\n\n  Vue.$gtag = Vue.prototype.$gtag = api;\n};\n","import { getVue, getRouter, getOptions } from \"./install\";\nimport { warn } from \"./util\";\nimport api from \"./api\";\nimport pageview from \"./api/pageview\";\nimport screenview from \"./api/screenview\";\n\nexport const getPageviewTemplate = (to = {}, from = {}) => {\n  const {\n    pageTrackerTemplate,\n    pageTrackerScreenviewEnabled,\n    appName,\n  } = getOptions();\n\n  let template;\n  const customTemplate = pageTrackerTemplate(to, from);\n\n  if (customTemplate) {\n    template = customTemplate;\n  } else if (pageTrackerScreenviewEnabled) {\n    template = {\n      app_name: appName,\n      screen_name: to.name,\n    };\n  } else {\n    template = {\n      page_title: to.name,\n      page_path: to.path,\n      page_location: window.location.href,\n    };\n  }\n\n  return template;\n};\n\nexport const trackPage = ({ to = {}, from = {}, params = {} } = {}) => {\n  const {\n    pageTrackerSkipSamePath,\n    pageTrackerScreenviewEnabled,\n  } = getOptions();\n\n  if (pageTrackerSkipSamePath && to.path === from.path) {\n    return;\n  }\n\n  const newParams = {\n    ...getPageviewTemplate(to, from),\n    ...params,\n  };\n\n  if (pageTrackerScreenviewEnabled && !newParams.app_name) {\n    warn(\"To use the screenview, add the appName to the plugin options\");\n    return;\n  }\n\n  if (pageTrackerScreenviewEnabled && !newParams.screen_name) {\n    warn(\"To use the screenview, name your routes\");\n    return;\n  }\n\n  if (pageTrackerScreenviewEnabled) {\n    screenview(newParams);\n    return;\n  }\n\n  pageview(newParams);\n};\n\nexport const startRouter = (Router) => {\n  const Vue = getVue();\n  const { onBeforeTrack, onAfterTrack, config } = getOptions();\n\n  /* istanbul ignore next */\n  Router.onReady((current) => {\n    Vue.nextTick().then(() => {\n      api.config(config.params);\n      trackPage({ to: current });\n    });\n\n    Router.afterEach((to, from) => {\n      Vue.nextTick().then(() => {\n        onBeforeTrack(to, from);\n        trackPage({ to, from });\n        onAfterTrack(to, from);\n      });\n    });\n  });\n};\n\nexport const autotrack = () => {\n  const Router = getRouter();\n\n  if (!Router) {\n    return;\n  }\n\n  startRouter(Router);\n};\n\nexport default autotrack;\n","import { isFn, loadScript } from \"./util\";\nimport api from \"./api\";\nimport { getRouter, getOptions } from \"../src/install\";\nimport optOut from \"./api/opt-out\";\nimport pageTracker from \"./page-tracker\";\n\nexport default function () {\n  if (typeof document === \"undefined\" || typeof window === \"undefined\") {\n    return;\n  }\n\n  const {\n    customResourceURL,\n    customPreconnectOrigin,\n    enabled,\n    globalObjectName,\n    globalDataLayerName,\n    config,\n    pageTrackerEnabled,\n    onReady,\n    deferScriptLoad,\n    disableScriptLoad,\n  } = getOptions();\n\n  const Router = getRouter();\n  const isPageTrackerEnabled = Boolean(pageTrackerEnabled && Router);\n\n  if (!enabled) {\n    optOut();\n  }\n\n  if (window[globalObjectName] == null) {\n    window[globalDataLayerName] = window[globalDataLayerName] || [];\n    window[globalObjectName] = function () {\n      window[globalDataLayerName].push(arguments);\n    };\n  }\n\n  window[globalObjectName](\"js\", new Date());\n\n  if (isPageTrackerEnabled) {\n    pageTracker();\n  } else {\n    api.config(config.params);\n  }\n\n  if (disableScriptLoad) {\n    return;\n  }\n\n  const resource = `${customResourceURL}?id=${config.id}&l=${globalDataLayerName}`;\n\n  return loadScript(resource, {\n    preconnectOrigin: customPreconnectOrigin,\n    defer: deferScriptLoad,\n  })\n    .then(() => {\n      const library = window[globalObjectName];\n\n      if (isFn(onReady)) {\n        onReady(library);\n      }\n\n      return library;\n    })\n    .catch((error) => {\n      return error;\n    });\n}\n","import { setOptions as _setOptions, install } from \"./install\";\nimport _bootstrap from \"./bootstrap\";\nimport api from \"./api\";\n\nexport default install;\nexport { install };\n\nexport const bootstrap = _bootstrap;\nexport const setOptions = _setOptions;\n\n// export api for usages outside Vuejs context\nexport const query = api.query;\nexport const config = api.config;\nexport const event = api.event;\nexport const pageview = api.pageview;\nexport const screenview = api.screenview;\nexport const customMap = api.customMap;\nexport const time = api.time;\nexport const exception = api.exception;\nexport const linker = api.linker;\nexport const purchase = api.purchase;\nexport const set = api.set;\nexport const optIn = api.optIn;\nexport const optOut = api.optOut;\nexport const refund = api.refund;\n"],"names":["noop","warn","msg","console","isObject","item","_typeof","Array","isArray","getOptions","globalObjectName","window","Vue","Router","args","config","includes","query","id","forEach","domain","name","_params","defaultGroupName","params","send_to","map","include","concat","arg","page_path","page_location","location","href","send_page_view","event","appName","screen_name","app_name","value","disable","pageview","screenview","customMap","custom_map","time","exception","linker","purchase","refund","set","optIn","optOut","getVue","$gtag","prototype","api","getPageviewTemplate","to","from","pageTrackerTemplate","pageTrackerScreenviewEnabled","customTemplate","page_title","path","trackPage","pageTrackerSkipSamePath","newParams","autotrack","getRouter","onBeforeTrack","onAfterTrack","onReady","current","nextTick","then","afterEach","startRouter","document","customResourceURL","customPreconnectOrigin","enabled","globalDataLayerName","pageTrackerEnabled","deferScriptLoad","disableScriptLoad","isPageTrackerEnabled","Boolean","push","arguments","Date","pageTracker","url","options","Promise","resolve","reject","head","getElementsByTagName","script","createElement","async","src","charset","defer","preconnectOrigin","link","rel","appendChild","onload","onerror","loadScript","library","catch","error","bootstrap","setOptions","_options","mergeDeep","target","sources","length","source","shift","key","Object","assign","install","_Vue","_Router","extend","_bootstrap","_setOptions"],"mappings":"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"}